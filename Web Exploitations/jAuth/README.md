# JAuth
- Link: https://play.picoctf.org/practice/challenge/236?category=1&page=4

## Tantangan
Most web application developers use third party components without testing their security. Some of the past affected companies are:
- Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
- Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
- VerticalScope (internet media company) - outdated version of vBulletin forum software used
Can you identify the components and exploit the vulnerable one?
The website is running [here](http://saturn.picoctf.net:49698/). Can you become an `admin`?
You can login as `test` with the password `Test123!` to get started.

## Penyelesaian
- Buka URL http://saturn.picoctf.net:49698/ di browser

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%201.JPG)

- Login dengan username `test` dan password `Test123!`

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%202.JPG)

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%203.JPG)

- Setelah berhasil login. Klik kanan halaman dan pilih Inspect

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%204.JPG)

- Pergi ke tab **Storage**

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%205.JPG)

- Double klik value token lalu tekan `Ctrl+C` untuk mengcopy

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%206.JPG)

- Buka web https://token.dev/ dan paste value token ke field **JWT String**

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%207.JPG)

- Ubah role menjadi `admin`

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%208.JPG)

- Hapus Signing key

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%209.JPG)

- Ganti Algorithm menjadi `none`

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%2010.JPG)

- Tambahkan tanda titik diakhir token

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%2011.JPG)

- Dari hasil diatas kita memperoleh token baru sebagai berikut
```sh
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNzA3NDY2MjAxMTczLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3MDc0NjYyMDF9.
```
- Double klik value token dan ganti dengan token diatas

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%2012.JPG)

- Reload halaman http://saturn.picoctf.net:49698/

![alt text](https://github.com/rahardian-dwi-saputra/picoCTF-writeup/blob/main/Web%20Exploitations/jAuth/assets/jauth%2013.JPG)

- Flag
```sh
picoCTF{succ3ss_@u7h3nt1c@710n_72bf8bd5}
```